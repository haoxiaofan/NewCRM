@{
    Layout = "~/Views/Shared/_LayoutApps.cshtml";
}
<div class="title">
    <ul>
        <li><a href="@Url.Action("SystemWallPaper", "PlatformSetting")">壁纸设置</a></li>
        <li class="focus">皮肤设置</li>
    </ul>
</div>
<ul class="skin" id="skinList"></ul>
<script>
    $(function () {
        loadAllSkin(function () {
            changeSkin();
        });
    });

    function loadAllSkin(callback) {
        $.get('@Url.Action("GetAllSkin", "PlatformSetting")', { __: Date.now }, function (result) {
            var html = '';
            $.each(result.data, function (k, v) {
                if ((v.currentUseSkin + '').length > 0) {
                    html += '<li skin="' + k + '" class="selected"><img src="' + v.imgPath + '"  data-css="' + v.cssPath + '"><div></div></li>';
                } else {
                    html += '<li skin="' + k + '"><img src="' + v.imgPath + '"  data-css="' + v.cssPath + '"><div></div></li>';
                }
            });
            $('#skinList').append(html);
            if (typeof (callback) === 'function') {
                callback && callback();
            }
        });
    }

    function changeSkin() {
        $('.skin li').on('click', function () {
            var skin = $(this).attr('skin');
            $('.skin li').removeClass('selected');
            $(this).addClass('selected');
            $.get('@Url.Action("ChangeSkin", "PlatformSetting")', { __: Date.now(), skin: skin }, function (result) {
                if (parseInt(result.data) === 1) {
                    window.parent.ZENG.msgbox.show("设置成功，如果没有更新请刷新页面", 4, 2000);
                    window.parent.HROS.base.getSkin(skin);
                }
            });
        });
    }
</script>